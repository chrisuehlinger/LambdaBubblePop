<html>
  <head>
    <script src="components/LinesComponents/Mixins.js"></script>
    <script src="bower_components/react/react.js"></script>
    <script src="bower_components/lodash/dist/lodash.js"></script>
    <script src="bower_components/node-uuid/uuid.js"></script>
    <script src="components/LinesComponents/LineComponent.js"></script>
    <script src="components/LinesComponents/ApplicationComponent.js"></script>
    <script src="components/LinesComponents/FunctionNameComponent.js"></script>
    <script src="components/LinesComponents/ListComponent.js"></script>
    <script src="components/LinesComponents/IntComponent.js"></script>
    <script src="components/LinesComponents/LinesComponent.js"></script>
    <script src="components/LinesComponents/NodeComponent.js"></script>
    <script src="ast_transformations.js"></script>
    <script src="initial_ast.js"></script>

    <link rel="stylesheet" href="app.css">
  </head>
  <body>
    <div id="lines">
    </div>
  </body>
  <script>
    // var functionDefinition = {
    //   typeSignature: "(a -> b) -> [a] -> [b]",
    //   name: "map",
    //   lines: [
    //     "map f []     = []",
    //     "map f (x:xs) = (f x)"
    //   ]
    // }



    var _globalState = {
      lines: [{ast: window.initialAST, clickedComputationId: null}],
      applicationHighlightId: null,
      highlightedLineIndex: null
    };

    var changeGlobalState = function(globalStateDiff) {
      _.extend(_globalState, globalStateDiff);

      React.renderComponent(
        Lines(_globalState),
        document.getElementById('lines')
      );
    };
    changeGlobalState({});

    window.addLineByApplying = function(id) {
      var lines = _.cloneDeep(_globalState.lines);

      lines[lines.length-1].clickedComputationId = id;
      lines.push({
        ast: ASTTransformations.applyFunction(lines[lines.length-1].ast, id),
        clickedComputationId: null
      });

      changeGlobalState({lines: lines});
    };

    window.highlightApplicationId = function(id) {
      changeGlobalState({applicationHighlightId: id});
    };

    window.highlightLine = function(index) {
      changeGlobalState({highlightedLineIndex: index});
    };
  </script>
</html>
